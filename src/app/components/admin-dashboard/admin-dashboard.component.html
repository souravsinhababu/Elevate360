<div class="dashboard-container">
  <!-- Modal for Edit Admin Details -->
<div *ngIf="showEditAdminModal" class="modal">
  <!-- Modal content -->
  <div class="modal-content">
    <h3>Edit Admin Details</h3>
 
    <form [formGroup]="editAdminForm" (ngSubmit)="onEditAdminSubmit()" class="edit-form">
      <label for="email">Email:</label>
      <input
        type="email"
        id="email"
        formControlName="email"
        required
        placeholder="Enter new email"
      />
      <div *ngIf="isInvalid('email')" class="error">
        Please enter a valid email.
      </div>
 
      <label for="password">Password:</label>
      <input
        type="password"
        id="password"
        formControlName="password"
        required
        placeholder="Enter new password"
      />
      <div *ngIf="isInvalid('password')" class="error">
        Password is required and should be at least 6 characters.
      </div>
 
      <!-- Buttons inside the form -->
      <div class="button-container">
        <button class="edit-password-button" (click)="openEditAdminModal()">Update</button>
        <button type="button" (click)="closeEditAdminModal()" class="close-btn">Close</button>
      </div>
    </form>
  </div>
</div>
 
<div class="header">
  <p class="welcome-message">Welcome, {{ adminname }}!</p>
  
  <!-- Wrap the buttons in a container for alignment -->
  <div class="button-container">
    <button class="edit-password-button" (click)="openEditAdminModal()">Edit</button>
    <button class="logout-button" (click)="logout()">Logout</button>
  </div>
</div>

 
  <h2>Welcome to the Admin Dashboard</h2>
 
  <!-- Card Statistics for Total Trainers and Trainees -->
  <div class="card-statistics">
    <div class="card">
      <h3>Total Trainers</h3>
      <div class="icon">
        <i class="fa fa-chalkboard-teacher"></i> <!-- Trainer Icon -->
      </div>
      <p>{{ trainers.length }}</p>
    </div>
    <div class="card">
      <h3>Total Trainees</h3>
      <div class="icon">
        <i class="fa fa-user-graduate"></i> <!-- Trainee Icon -->
      </div>
      <p>{{ trainees.length }}</p>
    </div>
  </div>
 
  <!-- Buttons to show Trainers and Trainees -->
  <div class="role-buttons">
    <button 
      (click)="showTrainers()" 
      [class.active]="isTrainerVisible">
      Show Trainers
    </button>
    <button 
      (click)="showTrainees()" 
      [class.active]="isTraineeVisible">
      Show Trainees
    </button>
  </div>
    <!-- Search and Filter Containers on the Same Line -->
    <div class="search-filter-container">
      <div class="search-container">
        <label for="search">Search: </label>
        <input type="text" [(ngModel)]="searchQuery" (ngModelChange)="search()" id="search" />
      </div>
    </div>
   
 
  <!-- List of Trainers -->
  <div *ngIf="isTrainerVisible">
    <h3>List of Trainers</h3>
    <div class="action-buttons">
      <button (click)="openAddTrainerModal()">Add Trainer</button>
    </div>
    <div *ngIf="trainers.length > 0">
      <table class="data-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Assign Courses</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let trainer of trainers">
            <td>{{ trainer.username }}</td>
            <td>{{ trainer.email }}</td>
            <td>
              <button (click)="openAssignCoursesModal(trainer)">Assign Courses</button>
            </td>
            <td>
              <button (click)="editTrainer(trainer)" class="btn btn-primary edit">
                <i class="fas fa-pencil-alt"></i> Edit
              </button>
              <button (click)="deleteTrainer(trainer.id)" class="btn btn-danger delete">
                <i class="fas fa-trash-alt"></i> Delete
              </button>
              <button (click)="openAssignTraineesModal(trainer)" class="btn btn-warning assign">
                <i class="fas fa-check"></i> Assign Trainee
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    <div *ngIf="trainers.length === 0">No trainers found.</div>
  </div>
 
  <!-- List of Trainees -->
  <div *ngIf="isTraineeVisible">
    <h3>List of Trainees</h3>
    <div class="action-buttons">
      <button (click)="openAddTraineeModal()">Add Trainee</button>
    </div>
    <div *ngIf="trainees.length > 0">
      <table class="data-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Trainer Name</th>
            <th>History</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let trainee of trainees">
            <td>{{ trainee.username }}</td>
            <td>{{ trainee.email }}</td>
            <td>{{ trainee.trainer_name }}</td>
            <td>
              <div *ngIf="courseHistory[trainee.id] && courseHistory[trainee.id].assignedCourses.length">
                <strong>{{ courseHistory[trainee.id].trainerName }}</strong>
                <ul>
                  <li *ngFor="let course of courseHistory[trainee.id].assignedCourses">
                    {{ course.courseName }} ({{ course.startDate }} - {{ course.endDate }})
                  </li>
                </ul>
              </div>
              <div *ngIf="!courseHistory[trainee.id] || !courseHistory[trainee.id].assignedCourses.length">
                No courses assigned yet.
              </div>
            </td>
            <td>
              <button (click)="editTrainee(trainee)" class="btn btn-primary edit">
                <i class="fas fa-pencil-alt"></i> Edit
              </button>
              <button (click)="deleteTrainee(trainee.id)" class="btn btn-danger delete">
                <i class="fas fa-trash-alt"></i> Delete
              </button>
              <button (click)="unassignTrainer(trainee)" class="btn btn-sm btn-info assign">
                <i class="fas fa-check"></i> Unassign Trainer
              </button>              
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
 
  <!-- Modals for Add/Edit/Assign (Same as previous code) -->
  <!-- Add Trainer Modal -->
  <div *ngIf="showAddTrainerModal" class="modal">
    <div class="modal-content">
      <app-add-trainer (addTrainer)="handleAddedTrainer($event)"></app-add-trainer>
      <button (click)="closeAddTrainerModal()" class="close-btn">Close</button>
    </div>
  </div>
 
  <!-- Add Trainee Modal -->
  <div *ngIf="showAddTraineeModal" class="modal">
    <div class="modal-content">
      <app-add-trainee (addTrainee)="handleAddedTrainee($event)"></app-add-trainee>
      <button (click)="closeAddTraineeModal()" class="close-btn">Close</button>
    </div>
  </div>
 
  <!-- Edit Trainee Modal -->
  <div *ngIf="showEditTraineeModal" class="modal">
    <div class="modal-content">
      <app-add-trainee [traineeData]="selectedTrainee" (addTrainee)="handleUpdatedTrainee($event)">
      </app-add-trainee>
      <button (click)="closeEditTraineeModal()" class="close-btn">Close</button>
    </div>
  </div>
 
  <!-- Edit Trainer Modal -->
  <div *ngIf="showEditTrainerModal" class="modal">
    <div class="modal-content">
      <app-add-trainer [trainerData]="selectedTrainer" (addTrainer)="handleAddedTrainer($event)" (updateTrainer)="handleUpdatedTrainee($event)">
      </app-add-trainer>
      <button (click)="closeEditTrainerModal()" class="close-btn">Close</button>
    </div>
  </div>
 
  <!-- Modal for Assigning Trainer -->
  <div *ngIf="isAssigningTrainer" class="modal">
    <div class="modal-content">
      <h4>Unassign Trainer from {{ selectedTrainee?.username }}</h4>
      <button (click)="unassignTrainerFromTrainee()">Unassign</button>
      <button (click)="cancelUnassign()">Cancel</button>
    </div>
  </div>
  
 
  <!-- Modal for Assigning Trainees -->
  <div *ngIf="isAssigningTrainees" class="modal">
    <div class="modal-content">
      <h4>Assign Trainees to {{ selectedTrainer?.username }}</h4>
      <div *ngFor="let trainee of trainees">
        <label>
          <input type="checkbox" [(ngModel)]="trainee.selected" />
          {{ trainee.username }}
        </label>
      </div>
      <button (click)="assignTraineesToTrainer()" [disabled]="!selectedTrainer">Assign</button>
      <button (click)="cancelAssignTrainees()">Cancel</button>
    </div>
  </div>
 
  <!-- Modal for Assigning Courses -->
<div *ngIf="isAssigningCourses" class="modal">
  <div class="modal-content">
    <h4>Assign Courses to {{ selectedTrainer?.username }}</h4>
    <div *ngFor="let category of availableCourses">
      <h5>{{ category.trainingCategory.category }}</h5>
      <div *ngFor="let course of category.courses">
        <label>
          <input type="checkbox" [(ngModel)]="selectedCourses[course]" />
          {{ course }}
        </label>
      </div>
    </div>
    <label for="startDate">Start Date:</label>
    <input type="date" id="startDate" [(ngModel)]="startDate" />
 
    <label for="endDate">End Date:</label>
    <input type="date" id="endDate" [(ngModel)]="endDate" />
    <button (click)="assignCoursesToTrainer()">Assign</button>
    <button (click)="cancelAssignCourses()">Cancel</button>
  </div>
</div>
 
</div>
 
 