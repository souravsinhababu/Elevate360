<div class="dashboard-container">
  <!-- Header Section -->
 
    <p class="welcome-message">Welcome, {{trainername}}!</p>
    <button class="edit-button" (click)="openEditTrainerModal()">Edit Details</button>
    <button class="logout-button" (click)="logout()">Logout</button>
 
 
  <!-- Edit Trainer Modal (Popup) -->
  <div *ngIf="showEditTrainerModal" class="modal">
    <div class="modal-content">
      <h3>Edit Trainer Details</h3>
      <form [formGroup]="editTrainerForm" (ngSubmit)="onEditTrainerSubmit()" class="edit-form">
        <label for="email">Email:</label>
        <input type="email" id="email" formControlName="email" placeholder="Enter new email" required />
        <div *ngIf="isInvalid('email')" class="error">Please enter a valid email.</div>
 
        <label for="password">Password:</label>
        <input type="password" id="password" formControlName="password" placeholder="Enter new password" required />
        <div *ngIf="isInvalid('password')" class="error">Password is required and should be at least 6 characters.</div>
 
        <div class="button-container">
          <button type="submit" class="save-button">Save Changes</button>
          <button type="button" (click)="closeEditTrainerModal()" class="close-btn">Close</button>
        </div>
      </form>
    </div>
</div>


  <h2>Trainer Dashboard</h2>
 
  <!-- Loading Message -->
  <div *ngIf="isLoading" class="loading-message">Loading trainees...</div>
 
  <!-- Trainee List Section -->
  <div *ngIf="!isLoading && trainees.length > 0">
    <section class="assigned-trainees">
      <h3 class="assigned-trainees-header">Assigned Trainees</h3>
      <table class="trainee-table">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let trainee of trainees">
            <td>{{ trainee.username }}</td>
            <td>{{ trainee.email }}</td>
          </tr>
        </tbody>
      </table>
    </section>
 
    <!-- Courses Section -->
    <section class="courses">
      <h3 class="courses-heading">Courses</h3>
      <div class="tabs">
        <button (click)="selectTab('ongoing')" [class.active]="selectedTab === 'ongoing'">Ongoing</button>
        <button (click)="selectTab('upcoming')" [class.active]="selectedTab === 'upcoming'">Upcoming</button>
        <button (click)="selectTab('history')" [class.active]="selectedTab === 'history'">History</button>
      </div>
 
      <!-- Ongoing Courses -->
      <div *ngIf="selectedTab === 'ongoing'" class="tab-content">
        <ul *ngIf="hasOngoingCourses()">
          <h4>Ongoing Courses</h4>
          <li *ngFor="let course of uniqueAssignedCourses">
            <div *ngIf="isOngoing(course)">
              <strong>{{ course.courseName }}</strong> (Start: {{ course.startDate }}, End: {{ course.endDate }})
            </div>
          </li>
        </ul>
        <p *ngIf="!hasOngoingCourses()">No Courses</p>
      </div>
 
      <!-- Upcoming Courses -->
      <div *ngIf="selectedTab === 'upcoming'" class="tab-content">
        <ul *ngIf="hasUpcomingCourses()">
          <h4>Upcoming Courses</h4>
          <li *ngFor="let course of uniqueAssignedCourses">
            <div *ngIf="isUpcoming(course)">
              <strong>{{ course.courseName }}</strong> (Start: {{ course.startDate }}, End: {{ course.endDate }})
            </div>
          </li>
        </ul>
        <p *ngIf="!hasUpcomingCourses()">No Courses</p>
      </div>
 
      <!-- Completed Courses -->
      <div *ngIf="selectedTab === 'history'" class="tab-content">
        <ul *ngIf="hasCompletedCourses()">
          <h4>Completed Courses</h4>
          <li *ngFor="let course of uniqueAssignedCourses">
            <div *ngIf="isCompleted(course)">
              <strong>{{ course.courseName }}</strong> (Start: {{ course.startDate }}, End: {{ course.endDate }})
            </div>
          </li>
        </ul>
        <p *ngIf="!hasCompletedCourses()">No Courses</p>
      </div>
    </section>
  </div>
 
  <!-- No Trainees Message -->
  <div *ngIf="!isLoading && trainees.length === 0" class="no-trainees-message">
    <p>No trainees assigned to you.</p>
  </div>
 
 <!-- Quiz Section -->
<section class="quiz-section">
  <h3>Create Quiz</h3>
  <form (ngSubmit)="submitQuiz()" #quizForm="ngForm">
    <!-- Dropdown to select course (dynamically populated from availableCourses) -->
    <label for="courseName">Select Course</label>
    <select [(ngModel)]="selectedCourseName" name="courseName" required #courseName="ngModel">
      <option value="" disabled>Select Course</option>
      <option *ngFor="let course of availableCourses" [value]="course">{{ course }}</option>
    </select>
    <div *ngIf="courseName.invalid && courseName.touched" class="error-message">
      Please select a course.
    </div>
 
    <!-- Add questions dynamically -->
    <div *ngFor="let question of questions; let i = index">
      <div class="question-container">
        <label for="question-{{i}}">Question {{i + 1}}</label>
        <input type="text" [(ngModel)]="question.question" name="question-{{i}}" required #question="ngModel" />
        <div *ngIf="question.invalid && question.touched" class="error-message">
          Please provide a question.
        </div>
 
        <!-- 4 Fixed Options -->
        <div *ngFor="let option of question.options; let j = index">
          <label for="option-{{i}}-{{j}}">Option {{j + 1}}</label>
          <input type="text" [(ngModel)]="option.option" name="option-{{i}}-{{j}}" required #option="ngModel" />
          <div *ngIf="option.invalid && option.touched" class="error-message">
            Please provide an option.
          </div>
 
          <!-- Correct Answer Radio Button for each option -->
          <input type="radio" [(ngModel)]="question.correctOption" name="correctOption-{{i}}" [value]="option" (change)="markCorrectOption(question, option)" />
          <label>Correct</label>
        </div>
 
        <!-- Validation for minimum 2 options and selecting a correct answer -->
        <div *ngIf="!hasMinimumTwoOptions(question)" class="error-message">
          A question must have four options.
        </div>
        <div *ngIf="!hasCorrectAnswer(question)" class="error-message">
          Please select a correct answer for this question.
        </div>
      </div>
    </div>
 
    <button type="button" (click)="addQuestion()">Add Question</button>
    <button type="submit" [disabled]="quizForm.invalid || questions.length === 0 || !selectedCourseName">Submit Quiz</button>
  </form>
</section>
 

 </div>