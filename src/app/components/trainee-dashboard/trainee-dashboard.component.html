<div class="dashboard-container">
  <h2>Welcome, {{ traineename }}</h2>

  <!-- Button to open Test popup -->
  <button (click)="openTestPopup()">Start Test</button>

  <!-- Test Modal in Fullscreen -->
  <div *ngIf="showModal" class="fullscreen-modal-backdrop" (click)="closeTestPopup()">
    <div class="fullscreen-modal-content" (click)="$event.stopPropagation()">
      <button class="fullscreen-close-btn" (click)="closeTestPopup()">Ã—</button>

      <!-- Show Course List or Exam Questions -->
      <div *ngIf="!currentExam">
        <h1>Select Course to Start Test</h1>

        <!-- List of Courses displayed as clickable boxes -->
        <div *ngIf="exams.length > 0" class="course-list">
          <div *ngFor="let exam of exams" class="course-box" (click)="startExam(exam)">
            <div class="course-title">{{ exam.courseName }}</div>
          </div>
        </div>
      </div>

      <div *ngIf="currentExam">
        <h2>{{ currentExam?.courseName }}</h2>
        <div class="question">
          <h3>{{ currentExam?.questions[currentQuestionIndex]?.question }}</h3>
          <div *ngFor="let option of currentExam?.questions[currentQuestionIndex]?.options; let i = index">
            <input type="radio" name="answer" [value]="option.option" id="option{{i}}">
            <label for="option{{i}}">{{ option.option }}</label><br>
          </div>
        </div>

        <div class="buttons">
          <button (click)="nextQuestion()" [disabled]="currentQuestionIndex === currentExam?.questions.length - 1">Next Question</button>
          <button *ngIf="currentQuestionIndex === currentExam?.questions.length - 1" (click)="submitTest()">Submit Test</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Button to open the form -->
  <button class="edit-button" (click)="openEditTraineeModal()">Edit Details</button>

  <!-- Modal for Editing Trainee Details -->
  <div *ngIf="showEditTraineeModal" class="modal">
    <div class="modal-content">
      <h3>Edit Trainee Details</h3>

      <form [formGroup]="editTraineeForm" (ngSubmit)="onEditTraineeSubmit()" class="edit-form">
        <div *ngFor="let field of formFields">
          <label [for]="field.id">{{ field.label }}:</label>
          <input
            [type]="field.type"
            [id]="field.id"
            [formControlName]="field.id"
            [required]="field.required"
            [placeholder]="field.placeholder"
          />
          <div *ngIf="isInvalid(field.id)" class="error">
            {{ field.errorMessage }}
          </div>
        </div>

        <div class="button-container">
          <button type="submit" class="save-button">Save Changes</button>
          <button type="button" (click)="closeEditTraineeModal()" class="close-btn">Close</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Logout button -->
  <button class="logout-button" (click)="logout()">Logout</button>
</div>
